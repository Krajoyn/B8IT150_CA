<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="../css/main.css">
  <title>Student Database DBS CA B8IT150</title>
  <script>
  let doIt=()=>{
  let tab=document.getElementById("studentTable");
  let rows=studentTable.getElementsByTagName('tr');
  fetch('https://akdbs.southindia.cloudapp.azure.com:8080/')
  .then(response => response.json())
  .then(data=>{data.Results.forEach(
  x=>{
  let newRow=rows[0].cloneNode(true);
  let divs=newRow.getElementsByTagName('th');
  divs[0].innerHTML=x['ID'];
  divs[1].innerHTML=x['Name'];
  divs[2].innerHTML=x['Email'];
  studentTable.appendChild(newRow);
  }
  );
  studentTable.setAttribute("style","\"\"");
  }
  );
  }
  </script>
</head>

<body>

  <img src="../images/main.jpg" alt="Graduation hat picture" width="1000" height="300">

  <table id='studentTable' style="display: none">
    <caption>Student Database</caption>
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
      </tr>
    </thead>
<!--     <tbody>
      <tr>
        <td></td>
        <td></td>
        <td></td>
      </tr> 
    </tbody> -->
  </table>

  <BR/>

  <button class="dbButton" onClick="doIt()">Display Student Database</button>
  <br/>

  <div class="button-group">
    <!-- ADD STUDENT BUTTON -->
    <input placeholder="Enter name to add" type='text' id='addName'>
    <input placeholder="Enter email to add" type='text' id='addEmail'>
    <button onClick="addStudent()">Add</button>

    <!-- DELETE BUTTON  -->
<!--     <input placeholder="Enter ID for deletion" type='int' id='deleteId'> -->
        <input placeholder="Enter ID" type='int' id='deleteId' id='updateId'>
    <button onClick="deleteStudent()">Delete</button>

    <!-- UPDATE BUTTON  -->
<!--     <input placeholder="Enter ID for update" type='int' id='updateId'> -->
    <input placeholder="Enter name for update" type='text' id='updateName'>
    <input placeholder="Enter email for update" type='text' id='updateEmail'>
    <button onClick="updateStudent()">Update</button>
  </div>

  <script>
    let baseURL='https://akdbs.southindia.cloudapp.azure.com:8080/';
    let id=document.querySelector('input');

  // ADD STUDENT
    let addStudent=()=>{
      fetch(baseURL+'add?name='+document.querySelector('#addName').value+'&email='+document.querySelector('#addEmail').value).then(resp=>{alert('Student added')});}

  // DELETE STUDENT
    let deleteStudent=()=>{
    fetch(baseURL+'delete?id='+document.querySelector('#deleteId').value).then((resp)=>{alert("Student Deleted")});}

  // UPDATE STUDENT
    let updateStudent=()=>{
      fetch(baseURL+'update?id='+document.querySelector('#updateId').value+'&name='+document.querySelector('#updateName').value+'&email='+document.querySelector('#updateEmail').value).then(resp=>{alert('Student Updated')});}
  </script>

</body>

</html>
