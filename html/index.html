<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="../css/main.css">
  <title>Test API Client</title>
  <script>
  let doIt=()=>{
  let tab=document.getElementById("student-table");
  let rows=student-table.getElementsByTagName('tr');
  fetch('https://akdbs.southindia.cloudapp.azure.com:8080/')
  .then(response => response.json())
  .then(data=>{data.Results.forEach(
  x=>{
  let newRow=rows[0].cloneNode(true);
  let divs=newRow.getElementsByTagName('td');
  divs[0].innerHTML=x['ID'];
  divs[1].innerHTML=x['Name'];
  divs[2].innerHTML=x['Email'];
  student-table.appendChild(newRow);
  }
  );
  student-table.setAttribute("style","\"\"");
  }
  );
  }
  </script>
</head>

<body>

  <button onClick="doIt()">Press me</button>
  <br/>

  <table id='student-table' style="display: none">
    <caption>Student Database</caption>
    <tr>
      <td>ID</td>
      <td>Name</td>
      <td>Email</td>
    </tr>
  </table>

  <BR/>



  <!-- ADD STUDENT BUTTON -->
  <input placeholder="Enter name to add" type='text' id='addName'>
  <input placeholder="Enter email to add" type='text' id='addEmail'>
  <button onClick="addStudent()">Add</button>

  <!-- DELETE BUTTON  -->
  <input placeholder="Enter ID for deletion" type='int' id='deleteId'>
  <button onClick="deleteStudent()">Delete</button>

  <!-- UPDATE BUTTON  -->
  <input placeholder="Enter ID for update" type='int' id='updateId'>
  <input placeholder="Enter name for update" type='text' id='updateName'>
  <input placeholder="Enter email for update" type='text' id='updateEmail'>
  <button onClick="updateStudent()">Update</button>

  <script>
    let baseURL='https://akdbs.southindia.cloudapp.azure.com:8080/';
    let id=document.querySelector('input');

  // ADD STUDENT
    let addStudent=()=>{
      fetch(baseURL+'add?name='+document.querySelector('#addName').value+'&email='+document.querySelector('#addEmail').value).then(resp=>{alert('Student added')});}

  // DELETE STUDENT
    let deleteStudent=()=>{
    fetch(baseURL+'delete?id='+document.querySelector('#deleteId').value).then((resp)=>{alert("Student Deleted")});}

  // UPDATE STUDENT
    let updateStudent=()=>{
      fetch(baseURL+'update?id='+document.querySelector('#updateId').value+'&name='+document.querySelector('#updateName').value+'&email='+document.querySelector('#updateEmail').value).then(resp=>{alert('Student Updated')});}
  </script>

</body>

</html>
